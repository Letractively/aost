#summary Tellurium Maven Guide.
#labels Phase-Support
<wiki:toc max_depth="3" />

= Introduction =

Tellurium has converted its project structure to use Maven. This document will explain the steps necessary to retrieve the Maven artifacts.

= Prerequisites =

You will need to be running Maven version 2.0.9, downloadable from http://maven.apache.org/download.html.

If you never installed Maven before, please follow [http://maven.apache.org/download.html#Installation the official Maven Installation Guide].

= settings.xml =

Here is a sample settings.xml that will allow you to automatically include Tellurium artifacts in your Maven project. This should go in your ~/.m2/settings.xml file:

{{{
<settings>
    <profiles>
        <profile>
            <activation>
                <activeByDefault>true</activeByDefault>
            </activation>
            <repositories>
                 <repository>  
                    <id>kungfuters-public-snapshots-repo</id>
                    <name>Kungfuters.org Public Snapshot Repository</name>
                    <releases>          
                        <enabled>false</enabled>
                    </releases>         
                    <snapshots>         
                        <enabled>true</enabled> 
                    </snapshots>        
                    <url>http://kungfuters.org/nexus/content/repositories/snapshots</url>
                </repository>   
                <repository>    
                    <id>kungfuters-public-releases-repo</id>
                    <name>Kungfuters.org Public Releases Repository</name>
                    <releases>          
                        <enabled>true</enabled> 
                    </releases>         
                    <snapshots>         
                        <enabled>false</enabled>
                    </snapshots>        
                    <url>http://kungfuters.org/nexus/content/repositories/releases</url>
                </repository>   
            </repositories>
        </profile>
    </profiles>
</settings>
}}}

= Dependency =

To include Tellurium as a dependency in your project, add the following to your pom.xml:

{{{
<dependencies>
    ...
    <dependency>
      <groupId>tellurium</groupId>
      <artifactId>tellurium-core</artifactId>
      <version>0.6.0-SNAPSHOT</version>
      <scope>compile</scope>
    </dependency>
    ...
</dependencies>
}}}

= Build Tellurium from Source =

If you want to build Tellurium from source, you can check out the trunk code using subversion command,

{{{
svn checkout http://aost.googlecode.com/svn/trunk/ tellurium
}}}

or using mvn command,

{{{
mvn scm:checkout -DconnectionUrl=scm:svn:http://aost.googlecode.com/svn/trunk -DcheckoutDirectory=tellurium
}}}

Be aware that the Maven command calls the subversion client to do the job and you must have the client installed in your system.

If you want to build the whole project, just use

{{{
mvn clean install
}}}

and Maven will compile source code and resources, compile test code and test resources, run all tests, and then install all artifacts to your local repository under YOUR_HOME/.m2/repository.

Sometimes, tests may break and if you still want to proceed, please use the ignore flag

{{{
mvn clean install -Dmaven.test.failure.ignore=true
}}} 

If you want to build an individual project, just go to that project directory and run the same command as above.

If you like to run the tests, use command

{{{
mvn test
}}}

The sub-projects under the tools directory include Tellurium Maven archetypes and trump code, you may not really want to build them by yourself. For trump, the artifacts include a .xpi file.

The assembly project just creates a set of tar files and you may not need to build it either. 

= Create a New Tellurium Test Project using Tellurium Maven Archetype =

Tellurium provides [http://code.google.com/p/aost/wiki/TelluriumMavenArchetypes two maven archetypes], i.e., tellurium-junit-archetype and tellurium-testng-archetype for Tellurium JUnit test project and Tellurium TestNG test project, respectively.

Run the following maven command to create a new JUnit project

{{{
mvn archetype:create -DgroupId=your_group_id -DartifactId=your_artifact_id -DarchetypeArtifactId=tellurium-junit-archetype -DarchetypeGroupId=tellurium -DarchetypeVersion=1.0-SNAPSHOT
}}}

Without adding the Tellurium Maven repository, you can specify it in the command line as
{{{
mvn archetype:create -DgroupId=your_group_id -DartifactId=your_artifact_id -DarchetypeArtifactId=tellurium-junit-archetype -DarchetypeGroupId=tellurium -DarchetypeVersion=1.0-SNAPSHOT \
                     -DarchetypeRepository=http://kungfuters.org/nexus/content/repositories/snapshots
}}}

For TestNG project, you should use a different archetype

{{{
mvn archetype:create -DgroupId=your_group_id -DartifactId=your_artifact_id -DarchetypeArtifactId=tellurium-testng-archetype -DarchetypeGroupId=tellurium -DarchetypeVersion=1.0-SNAPSHOT
}}}

If you want to see a detailed example on how to create a new Tellurium test project, you can read [http://code.google.com/p/aost/w/edit/TenMinutesToTellurium Ten Minutes To Tellurium]

= Build information =

To find regular build information updates, see http://kungfuters.org/tellurium. There you will find information about the project as well as unit test and coverage reports.

= Useful Maven Plugins and Commands =

== Maven Help Plugin ==

  * _help:active-profiles_ lists the profiles which are currently active for the build.
  * _help:all-profiles_ lists the available profiles under the current project.
  * _help:describe_ describes the attributes of a Plugin and/or a Mojo (Maven plain Old Java Object).
  * _help:effective-pom_ displays the effective POM as an XML for the current build, with the active profiles factored in.
  * _help:effective-settings_ displays the calculated settings as an XML for the project, given any profile enhancement and the inheritance of the global settings into the user-level settings.
  * _help:system displays_ a list of the platform details like system properties and environment variables.

== Maven Dependency Plugin ==

  * _dependency:resolve_ tells Maven to resolve all dependencies and displays the version.
  * _dependency:sources_ tells Maven to resolve all dependencies and their source attachments, and displays the version.
  * _dependency:resolve-plugins_ Tells Maven to resolve plugins and their dependencies.
  * _dependency:purge-local-repository_ tells Maven to clear all dependency-artifact files out of the local repository, and optionally re-resolve them.
  * _dependency:build-classpath_ tells Maven to output the path of the dependencies from the local repository in a classpath format to be used in java -cp. The classpath file may also be attached and installed/deployed along with the main artifact.
  * _dependency:analyze_ analyzes the dependencies of this project and determines which are: used and declared; used and undeclared; unused and declared.
  * _dependency:tree_ displays the dependency tree for this project.
  * _dependency:purge-local-repository -Dexclude=ARTIFACT_ delete all of the dependencies for the current project and re-resolved afterwards. You can disable this by specifying -DreResolve=false.


== Maven Archetype Plugin ==

  * _archetype:create_  creates a Maven 2 project from an archetype. 
  * _archetype:generate_ ask the user to choose an archetype from the archetype catalog, and retrieves it from the remote repository. Once retrieved, it is processed to create a working Maven project.
  * _archetype:create-from-project_ creates an archetype from an existing project.

= Maven IDE Configuration =

== Eclipse ==

=== Install Maven Plug-in ===

  # Click the Add Site button.
  # Enter the following URL: http://m2eclipse.sonatype.org/update/
  # Click OK.
  # Expand the Maven Integration for Eclipse Update Site node.
  # Select the Maven Integration check box.
  # Click the Install button and follow the wizard.
  # Restart Eclipse. 

=== Configure Maven Plug-in ===

  # Click Window | Preferences.
  # Expand the Maven node.
  # Select the Installations node.
  # Click the Add button.
  # Navigate the the Maven 2.0.9 installation folder.
  # Click OK.
  # Click the check box next to the new Maven installation.
 
=== Import Projects ===

  # Click File | Import.
  # Type Maven in the filter text field.
  # Under the General node, select the Maven Projects node.
  # Click Next.
  # Click the Browse button and navigate to the ide-settings folder.
  # Click OK.
  # Click Finish.

== Netbeans ==

=== Install Maven Plugin ===

Netbeans does not come with automatic support for Maven, you will need to install the plugin.

  # From the menu select Tools/Plugins
  # In the plugins screen, click on the Installed tab and Click on the Reload Catalog tab to get the list of available plugins. 
  # Select the Available Plugins tab and scroll down until you see the Maven plugin in.
  # Click on the check box next to this plug in and then select Install.
  # Follow the instructions to install the plug in. 

=== Configure Maven Plugin ===
 
  # Bring up the preferences dialog.
  # Select Miscellaneous and then click on the Maven tab.
  # Tools=>Options for Windows users.
  # Click on the Browse button next to the entry for External Maven Home. Navigate to the directory where you installed Maven and click Open.
  # Update the frequency with which your local repository is indexed

=== Import Projects ===

  # Click File | Open Project
  # Navigate to the ide-settings folder. 
  # Choose the pom.xml file and click open.
  
== IntelliJ ==
  
IntelliJ IDEA has Maven Plugin installed by default.

=== Configure Maven Plug-in ===
 
  # Click File | Settings to bring up the IDE settings window.
  # Click the Maven node.
  # Click the Override check box next to the Maven Home Directory text field.
  # Click the ... button.
  # Navigate to the Maven 2.0.9 installation directory.
  # Click OK.

=== Import Projects ===

  # Click File | Open Project
  # Choose the pom.xml file and click OK.

= Subversion Clients =

To check out code from google code SVN, you should use SVN client plugins in IDEs or you can use a standalone SVN client tools such as
  * [http://smartsvn.com SmartSVN]: a good cross-platform client that supports Subversion  up to 1.5
  * [http://tortoisesvn.tigris.org TortoiseSVN]: a good Windows client that supports Subversion up to 1.5

= Reference Material =

  * [http://www.sonatype.com/books/maven-book/reference/public-book.html Maven: The Definitive Guide]
  * [http://repo.exist.com/dist/maestro/1.7.0/BetterBuildsWithMaven.pdf Better Builds with maven]